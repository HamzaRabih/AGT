<!DOCTYPE html>
<html
        lang="en"
        class="light-style layout-menu-fixed"
        dir="ltr"
        data-theme="theme-default"
        data-assets-path="../assets/"
        data-template="vertical-menu-template-free"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout.html}"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
  <meta charset="utf-8" />
  <meta
          name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
  />

  <title>Do-it4me</title>

  <meta name="description" content="" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="img/LDFLOGO.png" />

  <!-- Data table ikns-->
  <link href="css/datatables.min.css" rel="stylesheet">

  <!--notif Js-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">

  <!-- Icons. Uncomment required icon fonts -->
  <link rel="stylesheet" href="css/boxicons.css" />
  <link rel="stylesheet" href="css/boxicons.css" />

  <!-- Core CSS -->
  <link rel="stylesheet" href="css/core.css" class="template-customizer-core-css" />
  <link rel="stylesheet" href="css/theme-default.css" class="template-customizer-theme-css" />
  <link rel="stylesheet" href="css/demo.css" />

  <!-- Vendors CSS -->
  <link rel="stylesheet" href="css/perfect-scrollbar.css" />

  <link rel="stylesheet" href="css/apex-charts.css" />
  <link rel="stylesheet" href="css/myCss.css" />

  <!-- Page CSS -->

  <!-- Helpers -->
  <script src="js/helpers.js"></script>

  <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
  <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
  <script src="js/config.js"></script>
</head>
<body>

<section layout:fragment="content">


  <!-- content-->
  <div class="container-fluid h-auto">
    <div class="content-wrapper">
      <!-- Content -->
      <div class="container-xxl flex-grow-1" STYLE="padding-top: 0px;margin-top: 2px;padding:0px;">
        <div class="row">

          <div class="card">
            <!--<h5 class="card-header">Table Basic</h5>-->
            <div class="card-body p-sm-3">


              <div th:if="${not #strings.isEmpty(msg) or not #strings.isEmpty(msg1) }" id="messages" class="mb-3 col-md-12">
                <div th:if="${not #strings.isEmpty(msg)}" class="show-message">
                  <div class="alert alert-success alert-dismissible" th:text="${msg}" role="alert">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                </div>
                <div th:if="${not #strings.isEmpty(msg1)}" class="show-message">
                  <div class="alert alert-success alert-dismissible" th:text="${msg1}" role="alert">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                </div>
              </div>

              <div class="table-responsive text-nowrap">

                <!--filtre-->
                <div class="d-flex align-items-center justify-content-start flex-nowrap pr-0 pl-0">
                  <div class="d-flex align-items-center mr-2" style="margin-right: 10px!important;">
                    <label for="membreSelect" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">Récepteur</label>
                    <select id="membreSelect" class="form-select form-select-sm Mycolor">
                      <option value="" selected="selected">Tout sélectionner</option>
                      <option th:each="p:${Recepteurs}" th:value="${p.idutilisateur}" th:text="${p.prenom + ' ' + p.nom}"></option>
                    </select>
                  </div>

                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label for="etapeSelect" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">Étape</label>
                    <select id="etapeSelect" class="form-select form-select-sm Mycolor">
                      <option value="" selected="selected">Tout sélectionner</option>
                      <option value="Aucune">Aucune</option>
                      <option value="Prospection" >Prospection</option>
                      <option value="Cadrage">Cadrage</option>
                      <option value="Livraison">Livraison</option>
                      <option value="Embauche">Embauche</option>
                      <option value="Encaissement">Encaissement</option>
                      <option value="Suivi">Suivi</option>
                      <option value="Formation">Formation</option>
                      <option value="Conseil">Conseil</option>
                    </select>
                  </div>

                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label for="statutSelect" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">Statut</label>
                    <select id="statutSelect" class="form-select form-select-sm Mycolor">
                      <option value="" selected="selected">Tout sélectionner</option>
                      <option value="Validée">Validé</option>
                      <option value="Terminée">Terminé</option>
                      <option value="En cours">En cours</option>
                      <option value="En attente">En attente</option>
                      <option value="Programmée">Programmé</option>
                      <option value="À refaire">À refaire</option>
                      <option value="Annulée">Annulé</option>
                    </select>
                  </div>


                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">Date</label>
                    <select id="dateSelected" class="form-select form-select-sm Mycolor">
                      <option value="ouverture" selected="selected"> Date ouverture</option>
                      <option value="objectif"> Date objectif</option>
                      <option value="cloture"> Date clôture</option>
                    </select>
                  </div>

                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label for="dateMinSelect" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">De</label>
                    <input class="form-control form-control-sm Mycolor" type="date" id="dateMinSelect">
                  </div>

                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label for="dateMaxSelect" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">À</label>
                    <input class="form-control form-control-sm Mycolor" type="date" id="dateMaxSelect">
                  </div>

                  <div class="d-flex align-items-center mr-2"  style="margin-right: 10px!important;">
                    <label for="rechercher" class="form-label-sm my-primary" style="margin-right: 5px; font-weight: 700;">Rechercher</label>
                    <input class="form-control form-control-sm Mycolor" type="text" id="rechercher">
                  </div>
                </div>
                <!--/filtre-->


                <table id="example" style="width:100%" class="table table-bordered table-sm table-secondary">
                  <thead>
                  <tr>
                    <th style="width: 100%;"
                        class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<p>Tâches</p>">
                      <svg  xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-task "  viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M2 2.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5zM3 3H2v1h1z"/>
                        <path d="M5 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M5.5 7a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1zm0 4a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1z"/>
                        <path fill-rule="evenodd" d="M1.5 7a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5zM2 7h1v1H2zm0 3.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm1 .5H2v1h1z"/>
                      </svg>
                      <label class="capitalize-first">Tâches</label>
                      <!--Tache-->
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Étape</span>"
                    > <!--Étape-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-steps" viewBox="0 0 16 16">
                        <path d="M.5 0a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-1 0V.5A.5.5 0 0 1 .5 0M2 1.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-6a.5.5 0 0 1-.5-.5zm2 4a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Récepteur</span>"
                    > <!--Recepteur-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-down-fill" viewBox="0 0 16 16">
                        <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414zM0 4.697v7.104l5.803-3.558zm.192 8.159 6.57-4.027L8 9.586l1.239-.757.367.225A4.49 4.49 0 0 0 8 12.5c0 .526.09 1.03.256 1.5H2a2 2 0 0 1-1.808-1.144M16 4.697v4.974A4.5 4.5 0 0 0 12.5 8a4.5 4.5 0 0 0-1.965.45l-.338-.207z"/>
                        <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-1.646a.5.5 0 0 1-.722-.016l-1.149-1.25a.5.5 0 1 1 .737-.676l.28.305V11a.5.5 0 0 1 1 0v1.793l.396-.397a.5.5 0 0 1 .708.708z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Status</span>"><!--Status-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Actions</span>"
                    > <!--Actions-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"/>
                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Durée retardée</span>"><!--dure retarde-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-x" viewBox="0 0 16 16">
                        <path d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708"/>
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Performance</span>"
                    > <!--performance-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-battery-charging" viewBox="0 0 16 16">
                        <path d="M9.585 2.568a.5.5 0 0 1 .226.58L8.677 6.832h1.99a.5.5 0 0 1 .364.843l-5.334 5.667a.5.5 0 0 1-.842-.49L5.99 9.167H4a.5.5 0 0 1-.364-.843l5.333-5.667a.5.5 0 0 1 .616-.09z"/>
                        <path d="M2 4h4.332l-.94 1H2a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h2.38l-.308 1H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2"/>
                        <path d="M2 6h2.45L2.908 7.639A1.5 1.5 0 0 0 3.313 10H2zm8.595-2-.308 1H12a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H9.276l-.942 1H12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"/>
                        <path d="M12 10h-1.783l1.542-1.639q.146-.156.241-.34zm0-3.354V6h-.646a1.5 1.5 0 0 1 .646.646M16 8a1.5 1.5 0 0 1-1.5 1.5v-3A1.5 1.5 0 0 1 16 8"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>progression</span>"><!--progression-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-battery-half" viewBox="0 0 16 16">
                        <path d="M2 6h5v4H2z"/>
                        <path d="M2 4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm10 1a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1zm4 3a1.5 1.5 0 0 1-1.5 1.5v-3A1.5 1.5 0 0 1 16 8"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Id tâche</span>"
                    > <!--idTache-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                        <path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2M2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Tâche mère</span>"
                    > <!--tâche mère-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bezier2" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1 2.5A1.5 1.5 0 0 1 2.5 1h1A1.5 1.5 0 0 1 5 2.5h4.134a1 1 0 1 1 0 1h-2.01q.269.27.484.605C8.246 5.097 8.5 6.459 8.5 8c0 1.993.257 3.092.713 3.7.356.476.895.721 1.787.784A1.5 1.5 0 0 1 12.5 11h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5H6.866a1 1 0 1 1 0-1h1.711a3 3 0 0 1-.165-.2C7.743 11.407 7.5 10.007 7.5 8c0-1.46-.246-2.597-.733-3.355-.39-.605-.952-1-1.767-1.112A1.5 1.5 0 0 1 3.5 5h-1A1.5 1.5 0 0 1 1 3.5zM2.5 2a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm10 10a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Émetteur</span>"
                    > <!--émetteur-->
                      <svg    style="margin-right: 0;margin-left: 0;"
                              xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send-fill" viewBox="0 0 16 16">
                        <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471z"/>
                      </svg>
                    </th>
                    <th style="margin-right: 0;margin-left: 0;"
                        class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Priorité</span>"><!--Priorité-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16">
                        <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5m.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Date ouverture</span>"
                    ><!--date ouverture-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-open" viewBox="0 0 16 16">
                        <path d="M8.47 1.318a1 1 0 0 0-.94 0l-6 3.2A1 1 0 0 0 1 5.4v.817l5.75 3.45L8 8.917l1.25.75L15 6.217V5.4a1 1 0 0 0-.53-.882zM15 7.383l-4.778 2.867L15 13.117zm-.035 6.88L8 10.082l-6.965 4.18A1 1 0 0 0 2 15h12a1 1 0 0 0 .965-.738ZM1 13.116l4.778-2.867L1 7.383v5.734ZM7.059.435a2 2 0 0 1 1.882 0l6 3.2A2 2 0 0 1 16 5.4V14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5.4a2 2 0 0 1 1.059-1.765z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Date objectif</span>"
                    ><!--date objectif-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar4-event" viewBox="0 0 16 16">
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"/>
                        <path d="M11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                      </svg>
                    </th>
                    <th  class="text-center Mycolor"
                         data-bs-toggle="tooltip"
                         data-bs-offset="0,4"
                         data-bs-placement="top"
                         data-bs-html="true"
                         title="<span>Durée estimée</span>"
                    ><!--dure estime-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hourglass-split" viewBox="0 0 16 16">
                        <path d="M2.5 15a.5.5 0 1 1 0-1h1v-1a4.5 4.5 0 0 1 2.557-4.06c.29-.139.443-.377.443-.59v-.7c0-.213-.154-.451-.443-.59A4.5 4.5 0 0 1 3.5 3V2h-1a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-1v1a4.5 4.5 0 0 1-2.557 4.06c-.29.139-.443.377-.443.59v.7c0 .213.154.451.443.59A4.5 4.5 0 0 1 12.5 13v1h1a.5.5 0 0 1 0 1zm2-13v1c0 .537.12 1.045.337 1.5h6.326c.216-.455.337-.963.337-1.5V2zm3 6.35c0 .701-.478 1.236-1.011 1.492A3.5 3.5 0 0 0 4.5 13s.866-1.299 3-1.48zm1 0v3.17c2.134.181 3 1.48 3 1.48a3.5 3.5 0 0 0-1.989-3.158C8.978 9.586 8.5 9.052 8.5 8.351z"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>Date cloture</span>"
                    ><!--date cloture-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-check-fill" viewBox="0 0 16 16">
                        <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-5.146-5.146-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708"/>
                      </svg>
                    </th>
                    <th class="text-center Mycolor"
                        data-bs-toggle="tooltip"
                        data-bs-offset="0,4"
                        data-bs-placement="top"
                        data-bs-html="true"
                        title="<span>A une tâche successive</span>"
                    > <!--tâches successif-->
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-right" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M6 8a.5.5 0 0 0 .5.5h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L12.293 7.5H6.5A.5.5 0 0 0 6 8m-2.5 7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5"/>
                      </svg>
                    </th>
                  </tr>
                  </thead>
                  <tbody class="table-border" id="tbody">

                  </tbody>
                </table>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  <!-- /content-->

  <!-- Core JS -->
  <!-- build:js assets/vendor/js/core.js -->
  <script src="js/jquery.js"></script>
  <script src="js/popper.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="js/perfect-scrollbar.js"></script>

  <script src="js/menu.js"></script>
  <!-- endbuild -->

  <!-- Vendors JS -->
  <script src="js/apexcharts.js"></script>

  <!-- Main JS -->
  <script src="js/main.js"></script>

  <!-- Page JS -->
  <script src="js/dashboards-analytics.js"></script>
  <script src="js/pages-account-settings-account.js"></script>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script src="js/myJs.js"></script>
  <!-- liens pour les websoket + Stom +Jquery. -->
  <script src="js/jquery.min.js"></script>
  <script src="js/sockjs.min.js"></script>
  <script src="js/stomp.min.js" ></script>
  <!--notif Js-->
  <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
  <!-- le script des websoket notification. -->
  <script src="js/notifWebSocket.js"></script>
  <!-- Data table -->
  <script src="js/datatables.min.js"></script>

  <style>
    /* Réduisez la largeur de l'entrée de recherche */
    div.dataTables_wrapper div.dataTables_filter input {
      width: 122px; /* Ajustez la largeur selon vos besoins */
      margin-top: 5px;!important; /* Ajustez la largeur selon vos besoins */
      color: #5A8DEE!important;
    }


    /* Cachez les divs initialement */
    .show-message {
      display: none;
    }

    /* Animation pour les divs */
    .show-message.show {
      display: block;
      opacity: 1;
      transition: opacity 0.5s ease-in-out;
    }

  </style>
  <script>
    //----- script pour les filtres et la validation , Refair et editer les taches
    var membreSelect = document.getElementById('membreSelect');
    const statutSelect = document.getElementById('statutSelect');
    var tbody = document.querySelector("#example tbody");
    var dateMinSelect = document.querySelector("#dateMinSelect");
    var dateMaxSelect = document.querySelector("#dateMaxSelect");
    var dateselect = document.querySelector("#dateSelected");
    var AllMembersTask=[];
    var membersTasksExcludingValidatedAndCancelled=[];
    var selectedStatuts=[""];
    var dateMax="";
    var utilisateurConnecte=[];
    var membres=[];
    var selectedDate="ouverture";

    getRole();
    getAllMembersTask();
    getTasksExcludingValidatedAndCancelled()
    tacheParentes();
    dateOuvertureactuelle();

    function getAllMembersTask(){
      fetch('getAllMembersTask')
              .then(response => response.json())
              .then(data => {
                // Update the table with the new data
                data.forEach(tache => {
                  AllMembersTask.push(tache);
                });
              })
    }

    //pour l affichage initial du table
    function getTasksExcludingValidatedAndCancelled(){
      fetch('getMembersTasksExcludingValidatedAndCancelled')
              .then(response => response.json())
              .then(data => {
                // Redraw the table
                $('#example').DataTable().destroy();
                // For example, you can clear the table content
                tbody.innerHTML = '';
                data.forEach(tache => {
                  membersTasksExcludingValidatedAndCancelled.push(tache);
                });
                createTableRow(membersTasksExcludingValidatedAndCancelled);
                datatableConf();
              })
    }

    // Fonction pour appliquer les filtres
    function applyFilters() {
      //update DataTable
      $('#example').DataTable().destroy();
      // supprimer le contenu du tableau
      tbody.innerHTML = '';
      const utilisateur = document.getElementById('membreSelect').value;
      const statut = document.getElementById('statutSelect').value;
      const etape = document.getElementById('etapeSelect').value;
      const dateType = document.getElementById('dateSelected').value;
      const dateMin = document.getElementById('dateMinSelect').value;
      const dateMax = document.getElementById('dateMaxSelect').value;
      var data =[];
      data =membersTasksExcludingValidatedAndCancelled;
      if (statut) {
        data =[]
        data = AllMembersTask;
      }
      // Filtrer les données
      const filteredData = data.filter(item => {
        const matchesUtilisateur = utilisateur ? item.recepteur.idutilisateur == utilisateur : true;
        const matchesStatut = statut ? item.statut === statut : true;
        const matchesEtape = etape ? item.etape === etape : true;
        const matchesDate = dateType === "ouverture" ? item.dateouverture :
                dateType === "objectif" ? item.dateobjectif :
                        item.dateTermineTache;
        const matchesDateMin = dateMin ? new Date(matchesDate) >= new Date(dateMin) : true;
        const matchesDateMax = dateMax ? new Date(matchesDate) <= new Date(dateMax) : true;
        return matchesUtilisateur && matchesStatut && matchesEtape && matchesDateMin && matchesDateMax;
      });
      // Mettre à jour l'affichage avec les données filtrées
      createTableRow(filteredData);
      datatableConf();
    }

    // Écoutez les changements sur les filtres
    document.getElementById('membreSelect').addEventListener('change', applyFilters);
    document.getElementById('statutSelect').addEventListener('change', applyFilters);
    document.getElementById('etapeSelect').addEventListener('change', applyFilters);
    document.getElementById('dateSelected').addEventListener('change', applyFilters);
    document.getElementById('dateMinSelect').addEventListener('change', applyFilters);
    document.getElementById('dateMaxSelect').addEventListener('change', applyFilters);
    document.getElementById('rechercher').addEventListener('input', applyFilters);

    function datatableConf() {
      $(document).ready(function () {
        // Récupérer la pagination sauvegardée (ou utiliser 10 par défaut si aucune valeur)
        const savedLength = localStorage.getItem('datatableLength') || 10;

        var table = $('#example').DataTable({
          info: false,
          lengthMenu: [10, 25, 50],
          pageLength: parseInt(savedLength), // Appliquer la pagination sauvegardée
          language: {
            "lengthMenu": "Afficher _MENU_ entrées",
            "search": "Rechercher :",
            "paginate": {
              "first": "Première",
              "last": "Dernière",
              "next": "Suivant",
              "previous": "Précédent"
            }
          },
          dom: '<"top">t<"bottom"lp>',
          order: []
        });

        // Événement lorsque l'utilisateur change la pagination
        table.on('length.dt', function (e, settings, len) {
          localStorage.setItem('datatableLength', len); // Sauvegarder la pagination choisie
        });

        // Recherche en direct
        $('#rechercher').on('keyup', function () {
          table.search(this.value).draw();
        });
      });
    }

    /*
    function datatableConf(){
      $(document).ready(function () {
        var table = $('#example').DataTable({
          info: false,
          lengthMenu: [10, 25, 50],
          language: {
            "lengthMenu": "Afficher _MENU_ entrées",
            "search": "Rechercher :",
            "paginate": {
              "first": "Première",
              "last": "Dernière",
              "next": "Suivant",
              "previous": "Précédent"
            }
          },
          dom: '<"top">t<"bottom"lp>',
          order: [] // Désactiver le tri initial
        });

        $('#rechercher').on('keyup', function() {
          table.search(this.value).draw();
        });
      });
    }
     */

    function progressPercentage(tache) {
      var currentDate = new Date().toISOString().split('T')[0]; // Obtenir la date actuelle en format 'YYYY-MM-DD'
      var dateOuverture = new Date(tache.dateouverture);
      var dateObjectif = new Date(tache.dateobjectif);
      var currentDateObj = new Date(currentDate); // Convertir la date actuelle en objet Date
      // Vérifier si les dates d'ouverture et d'objectif sont identiques
      if (dateOuverture.getTime() === dateObjectif.getTime()) {return 100;}
      // Si la date actuelle est supérieure ou égale à la date d'objectif
      if (currentDateObj >= dateObjectif) {return 100;}
      var jr=(24 * 60 * 60 * 1000);
      // Calculer le pourcentage de progression
      var ecoule = (currentDateObj.getTime() - dateOuverture.getTime())+jr;
      var total = (dateObjectif.getTime() - dateOuverture.getTime())+jr;
      // Calculer le pourcentage et s'assurer qu'il ne dépasse pas 100%
      var pourcentage = (ecoule / total) * 100;
      return Math.min(Math.round(pourcentage), 100); // Arrondir et s'assurer que le pourcentage ne dépasse pas 100
    }

    //fonction pours creer les linges de tableau
    function createTableRow(filteredData) {
      for (let i = 0; i < filteredData.length; i++) {
        // Créer une nouvelle ligne pour chaque tâche
        var newRow = document.createElement("tr");
        // Ajouter les cellules avec les données de la tâche à la nouvelle ligne
        var cellNomTache = document.createElement("td");
        cellNomTache.setAttribute("style"," display: flex;")
        cellNomTache.innerHTML = '     <p style="white-space: pre-wrap;margin: 0;min-width: 350px;max-width: 350px;min-height: 35px;height: auto">' + filteredData[i].nomtache + '</p>';
        newRow.appendChild(cellNomTache);

        var cellEtape = document.createElement("td");
        cellEtape.innerText = filteredData[i].etape != null ? filteredData[i].etape: 'Aucune';
        newRow.appendChild(cellEtape);

        var cellRecepteur = document.createElement("td");
        cellRecepteur.innerText = filteredData[i].recepteur != null ? filteredData[i].recepteur.prenom + ' ' + filteredData[i].recepteur.nom : '';
        newRow.appendChild(cellRecepteur);

        newRow.appendChild(createCelluleStatut(filteredData[i]));

        var cellAction = creationTdAction(filteredData[i]);
        newRow.appendChild(cellAction);

        var cellDureeRetarde = document.createElement("td");
        if (filteredData[i].dureretarde > 0) {
          cellDureeRetarde.innerText = filteredData[i].dureretarde;
          newRow.appendChild(cellDureeRetarde);
        } else {
          cellDureeRetarde.innerText = "";
          newRow.appendChild(cellDureeRetarde);
        }

        var cellPerformance = document.createElement("td");
        cellPerformance.innerText = filteredData[i].performance + '%';
        newRow.appendChild(cellPerformance);

        var cellProgression = document.createElement("td");
        cellProgression.innerText = progressPercentage(filteredData[i]) + '%';
        newRow.appendChild(cellProgression);

        var cellIdTache = document.createElement("td");
        cellIdTache.innerText = filteredData[i].idtache;
        newRow.appendChild(cellIdTache);

        var cellIdTacheMere = document.createElement("td");
        cellIdTacheMere.innerText = filteredData[i].tacheparente!=null?filteredData[i].tacheparente.idtache:'';
        newRow.appendChild(cellIdTacheMere);

        var cellEmetteur = document.createElement("td");
        cellEmetteur.innerText = filteredData[i].utilisateur != null ? filteredData[i].utilisateur.prenom + ' ' + filteredData[i].utilisateur.nom : '';
        newRow.appendChild(cellEmetteur);

        var cellPiorite = document.createElement("td");
        cellPiorite.innerText = filteredData[i].priorite != null ? filteredData[i].priorite.nompriorite : '';
        newRow.appendChild(cellPiorite);

        var cellDateOuverture = document.createElement("td");
        if (filteredData[i].dateouverture == null) {
          cellDateOuverture.innerText = '';
          newRow.appendChild(cellDateOuverture);
        } else {
          var dateOuverture = new Date(filteredData[i].dateouverture);
          var formattedDate =  ('0' + dateOuverture.getDate()).slice(-2) + '/' +('0' + (dateOuverture.getMonth() + 1)).slice(-2) + '/' + dateOuverture.getFullYear().toString().slice(-2);
          cellDateOuverture.innerText = formattedDate;
          newRow.appendChild(cellDateOuverture);
        }

        var cellDateObjectif = document.createElement("td");
        if (filteredData[i].dateobjectif == null) {
          cellDateObjectif.innerText = '';
          newRow.appendChild(cellDateObjectif);
        } else {
          var dateObjectif = new Date(filteredData[i].dateobjectif);
          var formattedDate =  ('0' + dateObjectif.getDate()).slice(-2) + '/' +('0' + (dateObjectif.getMonth() + 1)).slice(-2) + '/' + dateObjectif.getFullYear().toString().slice(-2);
          cellDateObjectif.innerText = formattedDate;
          newRow.appendChild(cellDateObjectif);
        }

        var cellDureeEstimee = document.createElement("td");
        cellDureeEstimee.innerText = filteredData[i].dureestime;
        newRow.appendChild(cellDureeEstimee);

        var cellDateCloture = document.createElement("td");
        if (filteredData[i].dateTermineTache == null) {
          cellDateCloture.innerText = '';
          newRow.appendChild(cellDateCloture);
        } else {
          var dateCloture = new Date(filteredData[i].dateTermineTache);
          var formattedDate =  ('0' + dateCloture.getDate()).slice(-2) +'/'+('0' + (dateCloture.getMonth() + 1)).slice(-2) +'/' +dateCloture.getFullYear().toString().slice(-2);
          cellDateCloture.innerText = formattedDate;
          newRow.appendChild(cellDateCloture);
        }

        var cellTacheSucc = document.createElement("td");
        if (filteredData[i].aunetachesuccessive) {cellTacheSucc.innerText = '✔';}
        else {cellTacheSucc.innerText = '✘';}
        newRow.appendChild(cellTacheSucc);

        // Ajouter la nouvelle ligne au corps du tableau
        var tableBody = document.querySelector("#example tbody");
        tableBody.appendChild(newRow);
      }
    }

    function createCelluleStatut(tache) {
      var cellStatut = document.createElement("td");
      cellStatut.classList.add("text-sm-center")
      var statutBadge = document.createElement("span");
      statutBadge.setAttribute("style","width: 100px !important");
      statutBadge.setAttribute("data-id", tache.idtache);
      statutBadge.className = "";

      switch (tache.statut) {
        case "En cours":
          statutBadge.classList.add("bg-info","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "En cours";
          break;
        case "Terminée":
          statutBadge.classList.add("bg-success","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "Terminée";
          break;
        case "Programmée":
          statutBadge.classList.add("bg-primary","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "Programmée";
          break;
        case "Validée":
          statutBadge.classList.add("bg-secondary","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "Validée";
          break;
        case "À refaire":
          statutBadge.classList.add("bg-danger","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "À refaire";
          break;
        case "En attente":
          statutBadge.classList.add("bg-warning","badge","rounded-pill","capitalize-first");
          statutBadge.innerText = "En attente";
          break;
        case "Annulée":
          statutBadge.classList.add("bg-dark","badge","rounded-pill","capitalize-first");
          statutBadge.setAttribute("style","color: white !important;width: 100px !important");
          statutBadge.innerText = "Annulée";
          break;
        default:
          statutBadge.innerText = "Statut inconnu";
      }
      statutBadge.classList.add("statutsClasse");
      cellStatut.appendChild(statutBadge);
      return cellStatut;
    }

    //pour creer le champ action (les trois butons)
    function creationTdAction(tache) {
      //console.log(tache.utilisateur.role.role)
      var cellAction = document.createElement("td");
      //dropdown div
      var divDropdown=document.createElement("div");
      divDropdown.classList.add("dropdown");
      var button = document.createElement("button");
      button.setAttribute("type", "button");
      button.setAttribute("class", "btn p-0 dropdown-toggle hide-arrow");
      button.setAttribute("data-bs-toggle", "dropdown");

      if ( tache.statut !=="Annulée" && tache.statut !== "Validée"){
        //creer la Menu
        creerMenu(button,cellAction,divDropdown,tache);
      }
      return cellAction;
    }

    function creerMenu(button,cellAction,divDropdown,tache) {
      //creer la Menu
      var icon = document.createElement("i");
      icon.setAttribute("class", "bx bx-dots-vertical-rounded");
      button.appendChild(icon);
      divDropdown.appendChild(button);

      //Menu
      var MenuDiv=document.createElement("div");
      MenuDiv.classList.add("dropdown-menu");

      // Créer le lienValider
      if(tache.statut ==="Terminée" && tache.utilisateur.idutilisateur===utilisateurConnecte[0].idutilisateur){
        var lienValider = document.createElement("a");
        lienValider.setAttribute("class", "dropdown-item");
        var iconeValider = document.createElement("i");
        iconeValider.setAttribute("class", "bx bx-check");
        lienValider.appendChild(iconeValider);
        lienValider.appendChild(document.createTextNode(" Valider"));
        lienValider.setAttribute("data-id", tache.idtache);
        lienValider.addEventListener('click', () => valideTache(tache.idtache));
        MenuDiv.appendChild(lienValider);
      }

      // Créer le lien lienRefaire
      if(tache.statut ==="Terminée" && tache.utilisateur.idutilisateur===utilisateurConnecte[0].idutilisateur) {
        var lienRefaire = document.createElement("a");
        lienRefaire.setAttribute("class", "dropdown-item");
        var iconeRefaire = document.createElement("i");
        iconeRefaire.setAttribute("class", "bx bx-refresh");
        lienRefaire.appendChild(iconeRefaire);
        var texteRefaire = document.createTextNode("À refaire");
        lienRefaire.appendChild(texteRefaire);
        lienRefaire.setAttribute("data-id", tache.idtache);
        lienRefaire.addEventListener('click', () => refaireTache(tache.idtache));
        MenuDiv.appendChild(lienRefaire);
      }


      // Créer le lien lienAnnuler
      if ((tache.statut !=="Validée"  && tache.statut !=="Terminée" &&  tache.statut !=="Annulée"
              && tache.utilisateur.idutilisateur===utilisateurConnecte[0].idutilisateur)
      ) {
        var lienAnnuler = document.createElement("a");
        lienAnnuler.setAttribute("class", "dropdown-item");
        var iconeAnnuler = document.createElement("i");
        iconeAnnuler.setAttribute("class", "bx bx-message-alt-x");
        lienAnnuler.appendChild(iconeAnnuler);
        var texteEditer = document.createTextNode(" Annuler");
        lienAnnuler.appendChild(texteEditer);
        lienAnnuler.setAttribute("data-id", tache.idtache);
        lienAnnuler.addEventListener('click', () => annulerTache(tache.idtache));
        MenuDiv.appendChild(lienAnnuler);
      }

      // Créer le lien lienEditer
      if (utilisateurConnecte[0].role.role !== "Utilisateur" && tache.statut !== "Terminée" && tache.statut !== "Validée" && tache.statut !=="Programmée") {
        var lienEditer = document.createElement("a");
        lienEditer.setAttribute("class", "dropdown-item");
        var iconeEditer = document.createElement("i");
        iconeEditer.setAttribute("class", "bx bx-edit-alt");
        lienEditer.appendChild(iconeEditer);
        var texteEditer = document.createTextNode("  Éditer");
        lienEditer.appendChild(texteEditer);
        lienEditer.setAttribute("data-id", tache.idtache);
        lienEditer.addEventListener('click', () => editerTache(tache.idtache));
        MenuDiv.appendChild(lienEditer);
      }

      // Créer le lien lienIndexer
      if (tache.statut !=="Validée"   &&  tache.statut !=="Annulée" ) {
        var lienAnnuler = document.createElement("a");
        lienAnnuler.setAttribute("class", "dropdown-item");
        // Créer l'élément SVG
        var iconeAnnuler = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        iconeAnnuler.setAttribute("xmlns", "http://www.w3.org/2000/svg");
        iconeAnnuler.setAttribute("width", "16");
        iconeAnnuler.setAttribute("height", "16");
        iconeAnnuler.setAttribute("fill", "currentColor");
        iconeAnnuler.setAttribute("class", "bi bi-bezier2");
        iconeAnnuler.setAttribute("viewBox", "0 0 16 16");
        // Créer et ajouter le chemin à l'élément SVG
        var cheminSVG = document.createElementNS("http://www.w3.org/2000/svg", "path");
        cheminSVG.setAttribute("fill-rule", "evenodd");
        cheminSVG.setAttribute("d", "M1 2.5A1.5 1.5 0 0 1 2.5 1h1A1.5 1.5 0 0 1 5 2.5h4.134a1 1 0 1 1 0 1h-2.01q.269.27.484.605C8.246 5.097 8.5 6.459 8.5 8c0 1.993.257 3.092.713 3.7.356.476.895.721 1.787.784A1.5 1.5 0 0 1 12.5 11h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5H6.866a1 1 0 1 1 0-1h1.711a3 3 0 0 1-.165-.2C7.743 11.407 7.5 10.007 7.5 8c0-1.46-.246-2.597-.733-3.355-.39-.605-.952-1-1.767-1.112A1.5 1.5 0 0 1 3.5 5h-1A1.5 1.5 0 0 1 1 3.5zM2.5 2a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm10 10a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z");
        iconeAnnuler.appendChild(cheminSVG);
        // Ajouter l'élément SVG à l'élément <a>
        lienAnnuler.appendChild(iconeAnnuler);
        // Créer et ajouter le texte " Indexer" à l'élément <a>
        var texteEditer = document.createTextNode(" Indexer");
        lienAnnuler.appendChild(texteEditer);
        // Définir les attributs supplémentaires
        lienAnnuler.setAttribute("data-id", tache.idtache);
        lienAnnuler.addEventListener('click', () => indexeTache(tache.idtache));
        // Ajouter le lien à votre élément MenuDiv
        MenuDiv.appendChild(lienAnnuler);
      }

      divDropdown.appendChild(MenuDiv);
      cellAction.appendChild(divDropdown);
    }

    //fonction pour valider une tache
    function valideTache(tacheId) {
      // Obtenir l'ID de la tâche et le statut actuel à partir des attributs data
      // const tacheId = button.getAttribute("data-id");
      // Envoyer une requête AJAX pour mettre à jour le statut de la tâche
      $.ajax({
        url: `ValiderStatut/${tacheId}`,
        method: 'GET',
        success: function (tache) {
          reinitialiserFiltre();
          //vider la liste
          membersTasksExcludingValidatedAndCancelled=[];
          //affichage initial du tableau
          getTasksExcludingValidatedAndCancelled();
          // Afficher le message de validation
          messageNotif();
        }
      });
    }

    //fonction pour Refair une tache
    function refaireTache(tacheId) {
      // Obtenir l'ID de la tâche et le statut actuel à partir des attributs data
      // const tacheId = button.getAttribute("data-id");
      // Envoyer une requête AJAX pour mettre à jour le statut de la tâche
      $.ajax({
        url: `RefaireTache/${tacheId}`,
        method: 'GET',
        success: function (tache) {
          reinitialiserFiltre();
          //vider la liste
          membersTasksExcludingValidatedAndCancelled=[];
          //affichage initial du tableau
          getTasksExcludingValidatedAndCancelled();
          // Afficher le message de validation
          messageNotif();
        }
      });
    }

    function annulerTache(tacheId) {
      $.ajax({
        url: `AnnulerTache/${tacheId}`,
        method: 'GET',
        success: function (tache){
          reinitialiserFiltre();
          //vider la liste
          membersTasksExcludingValidatedAndCancelled=[];
          //affichage initial du tableau
          getTasksExcludingValidatedAndCancelled();
          // Afficher le message de validation
          messageNotif();
        }
      });}

    function indexeTache(tacheId) {
      $.ajax({
        url: `indexerTache/${tacheId}`,
        method: 'GET',
        success: function (tache) {
          reinitialiserFiltre();
          //vider la liste
          membersTasksExcludingValidatedAndCancelled=[];
          tacheParentes();
          // Afficher le message de validation
          messageNotif();
        }
      });
    }

    //Pour afficher les taches parentes dans la liste déroulante
    // dans le formulaire qui permet de créer une tâche
    // et actualiser la liste lorsqu'une indexation
    function tacheParentes() {
      $.ajax({
        url: `tachesParentes/`,
        method: 'GET',
        success: function (taches) {
          var tachesParentSelect = $("#tacheparente");
          tachesParentSelect.empty(); // Efface toutes les options actuelles
          tachesParentSelect.append (new Option("Selectionner la tâche parente",-1));
          for (var i = 0; i < taches.length; i++) {
            var option = new Option(taches[i].etape+"-"+taches[i].nomtache+"-"+taches[i].idtache, taches[i].idtache);
            tachesParentSelect.append(option);
          }
        }
      });
    }

    //Pour editer une tache dans la meme forme
    function editerTache(idtache1) {
      afficherFormulaireCreeTache();
      const idtache = idtache1;
      const form = document.getElementById("formAccountSettings");
      var   btnSubmit= document.getElementById('submit');
      // Set the idDepartement input field value and update the button text
      form.querySelector("input[name='idtache']").value = idtache;
      btnSubmit.textContent = "Mettre à jour";
      // Fetch Domaine details using AJAX
      $.ajax({
        type: "GET", // You may need to adjust this to your backend API
        url: `get-Tache/${idtache}`, // Replace with your API endpoint
        success: function(data) {//returns data in JSON format
          // Pre-fill the form fields
          form.querySelector("input[name='Utilisateur']").value = data.utilisateur.idutilisateur;
          form.querySelector("input[name='nomtache']").value = data.nomtache;
          form.querySelector("input[name='dureestime']").value = data.dureestime;
          form.querySelector("input[name='dateouverture']").value = data.dateouverture;

          //si la departement a une societé
          if(data.commentaire!=null)
          {form.querySelector("input[name='commentaire']").value = data.commentaire;}

          if (data.type != null)
          {form.querySelector("select[name='type']").value = data.type;}

          if (data.etape != null)
          {form.querySelector("select[name='etape']").value = data.etape;}

          if (data.proprietaire != null) {
            // Pre-select the Proprietaire in the dropdown
            const select1 = form.querySelector("select[name='proprietaire']");
            const Proprietaire = data.proprietaire;
            const ProprietaireOption = select1.querySelector(`option[value="${Proprietaire.idutilisateur}"]`);
            ProprietaireOption.setAttribute("selected", "selected");
          }

          if (data.priorite != null) {
            // Pre-select the Proprietaire in the dropdown
            const select1 = form.querySelector("select[name='priorite']");
            const PrioriteOption = select1.querySelector(`option[value="${data.priorite.idpriorite}"]`);
            PrioriteOption.setAttribute("selected", "selected");
          }

          if (data.recepteur != null) {
            // Pre-select the Recepteur in the dropdown
            const select = form.querySelector("select[name='recepteur']");
            const recepteurId = data.recepteur;
            const recepteurOption = select.querySelector(`option[value="${recepteurId.idutilisateur}"]`);
            recepteurOption.setAttribute("selected", "selected");

            select.setAttribute("readonly", "readonly");
            select.onmousedown = function () { return false; };
            select.style.cursor = "default";
            select.style.backgroundColor='rgba(239,239,239,0.77)'
          }

          // Disable editing and selection for tacheparente
          const select = form.querySelector("select[name='tacheparente']");
          select.setAttribute("readonly", "readonly");
          select.onmousedown = function () { return false; };
          select.style.cursor = "default";
          select.style.backgroundColor='rgba(239,239,239,0.77)'

          // Disable editing and selection for nomtache
          const inputField = form.querySelector(`input[name='nomtache']`);
          inputField.setAttribute("readonly", "readonly");
          inputField.onmousedown = function () { return false; };
          inputField.style.cursor = "default";
          inputField.style.backgroundColor='rgba(239,239,239,0.77)'

          if (data.aunetachesuccessive != null) {
            // Pre-select the Proprietaire in the dropdown
            const select1 = form.querySelector("select[name='aunetachesuccessive']");
            const TacheSucc = data.aunetachesuccessive;
            const TacheSuccOption = select1.querySelector(`option[value="${TacheSucc}"]`);
            TacheSuccOption.setAttribute("selected", "selected");

          }

        },
        error: function(err) {
          // Handle the error if needed
          console.error(err);
        }
      });



    }

    function afficherFormulaireCreeTache(){
      //pour afficher le form
      // Récupérer l'élément du bouton par son attribut 'class'
      var bouton = document.getElementById("creertache");
      // Vérifier si le bouton a été trouvé
      if (bouton) {
        // Déclencher le clic sur le bouton
        bouton.click();
      } else {
        console.error('Le bouton n\'a pas été trouvé.');
      }
      //srcipt permet de défiler la page vers le haut lorsque l'utilisateur clique sur un bouton
      // Faites défiler la page vers le haut
      window.scrollTo({
        top: 0, // La position en pixels en haut de la page
        behavior: "smooth" // Option pour un défilement fluide
      });
    }
    //fonction pour afficher les msgs
    function messageNotif(){
      // Create an instance of Notyf
      var notyf = new Notyf();
      // Display a success notification
      notyf.success('Opération terminée avec succès.');
    }

    function annuler() {
      // Récupérer l'élément du formulaire par son ID
      var formulaire = document.getElementById('formAccountSettings');
      var   btnSubmit= document.getElementById('submit');
      var inputEDateOuverture = document.getElementById("DateOuverture");

      // Vérifier si le formulaire a été trouvé
      if (formulaire) {
        // Réinitialiser le formulaire
        formulaire.reset();

        if ( btnSubmit.textContent === "Mettre à jour") {btnSubmit.textContent = "Envoyer";}

        // Pre-select the Proprietaire in the dropdown
        const select1 = formulaire.querySelector("select[name='proprietaire']");
        select1.removeAttribute("readonly");
        select1.onmousedown = null;
        select1.style.cursor = "default";

        // Pre-select the Recepteur in the dropdown
        const select = formulaire.querySelector("select[name='recepteur']");
        select.removeAttribute("readonly");
        select.onmousedown = null;
        select.style.cursor = "default";

        //remove Disable editing and selection for nomtache
        const inputField = formulaire.querySelector(`input[name='nomtache']`);
        inputField.removeAttribute("readonly");
        inputField.onmousedown = null; // Supprimer l'événement onmousedown
        inputField.style.cursor = "text"; // Changer le style du curseur en mode édition

        const idTacheInput = formulaire.querySelector(`input[name='idtache']`);
        idTacheInput.value=null;
        idTacheInput.textContent="";


        // Disable editing and selection for tacheparente
        const selec = formulaire.querySelector("select[name='tacheparente']");
        selec.removeAttribute("readonly");
        selec.onmousedown = null;
        selec.style.cursor = "default";

        //Date d ouverture
        const inputEDateOuverture = formulaire.querySelector(`input[name='dateouverture']`);
        inputEDateOuverture.removeAttribute("readonly");
        inputEDateOuverture.onmousedown = null;
        inputEDateOuverture.style.cursor = "default";
        inputEDateOuverture.disabled=false;
        inputEDateOuverture.onmousedown = null; // Supprimer l'événement onmousedown
        //inputEDateOuverture.style.cursor = "text"; // Changer le style du curseur en mode édition
        dateOuvertureactuelle();
      } else {
        console.error('Le formulaire n\'a pas été trouvé.');
      }
    }

    function reinitialiserFiltre() {
      //----/reselectionné les premieres valeurs des filtres
      // Parcourez toutes les options de la liste déroulante
      for (var i = 0; i < membreSelect.options.length; i++) {
        // Définissez la propriété selected de chaque option sur false
        membreSelect.options[i].selected = false;
      }
      // Définissez la première option comme sélectionnée
      membreSelect.options[0].selected = true;

      // Parcourez toutes les options de la liste déroulante
      for (var i = 0; i < statutSelect.options.length; i++) {
        // Définissez la propriété selected de chaque option sur false
        statutSelect.options[i].selected = false;
      }
      // Définissez la première option comme sélectionnée
      statutSelect.options[0].selected = true;
      //----/reselectionné les premieres valeurs des filtres
    }

    //Trouver le role d utilisateur connecté
    function getRole() {
      $.ajax({
        url: `Role`,
        method: 'GET',
        success: function (data) {
          utilisateurConnecte.push(data);
        },
        error: function (error) {
          console.error("Une erreur s'est produite lors de la récupération du rôle :", error);
        }
      });
    }

    // Sélectionnez tous les éléments avec la classe "show-message"
    var messageElements = document.querySelectorAll('.show-message');

    // Parcourir chaque élément et ajouter la classe "show" (pour l'animation)
    messageElements.forEach(function(element) {
      // Ajouter la classe "show" pour les rendre visibles avec l'animation CSS
      element.classList.add('show');

      // Supprimer la classe "show" après 5 secondes
      setTimeout(function() {
        element.classList.remove('show');
      }, 5000);
    });

    // Sélectionnez l'élément avec l'id "messages"
    var messagesDiv = document.getElementById("messages");

    // Supprimez la div après 5 secondes (5000 millisecondes)
    setTimeout(function() {
      if (messagesDiv) {
        messagesDiv.remove();
      }
    }, 5500);

    //pour afficher la date d'ouverture
    function dateOuvertureactuelle(){
      //pour la date douverture
      // Obtenez la date actuelle au format YYYY-MM-DD
      var currentDate = new Date().toISOString().split('T')[0];

      // Mettez à jour l'attribut 'min' du champ de saisie de date avec la date actuelle
      document.getElementById('DateOuverture').min = currentDate;

      // Mettez à jour l'attribut 'value' du champ de saisie de date avec la date actuelle
      document.getElementById('DateOuverture').value = currentDate;
    }


    /*

   // Appel de la fonction fetch pour récupérer les membres de l'équipe de l'utilisateur connecté
    fetch('membresDeLequipeDutilisateur', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        // Vous pouvez également ajouter des en-têtes supplémentaires si nécessaire
      },
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('Erreur de réseau');
              }
              return response.json();
            })
            .then(data => {
              // Les données récupérées (liste de membres) sont stockées dans la variable data
              data.forEach(user=>{
                membres.push(user)
              })
            })
            .catch(error => {
              console.error('Erreur lors de la récupération des membres:', error);
            });

    //pour verifier si l'utilisateur donneé est un membre de l'equipe de l'utilisateur connecté ou non
    function isMember(utilisateur){
      // Utilisation d'une boucle for pour itérer sur les éléments du tableau
      for (var i = 0; i < membres.length; i++) {
        if (membres[i].idutilisateur===utilisateur.idutilisateur) {
          return true
        };
      }
      return false
    }

    membreSelect.addEventListener('change', () => {
      // Check if "tout sélectionner" is selected
      if (membreSelect.value === "") {
        // Redraw the table
        $('#example').DataTable().destroy();
        tbody.innerHTML = '';
        console.log(selectedStatuts);
        // Perform actions when "tout sélectionner" is selected
        //getAllMembersTask();
        tacheOfselectedMembres= AllMembersTask;
        console.log(selectedDate)


        const isStatutsSelectionneTousSelected=contientValeurVide(selectedStatuts);
        if (isStatutsSelectionneTousSelected && dateMin=="" && dateMax=="") {
          // Clear existing data
          AllMembersTask.forEach(tache => {
            createTableRow(tache);
          });

        }
        if (isStatutsSelectionneTousSelected && dateMin=="" && dateMax!="") {
          //$('#example').DataTable().clear();
          AllMembersTask.forEach(tache => {
            if (selectedDate=="ouverture") {
              if (tache.dateouverture<=dateMax) {
                createTableRow(tache);
              }

            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if ( tache.dateobjectif<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate==="cloture") {
              if (tache.dateTermineTache!=null) {
                if (tache.dateTermineTache<=dateMax) {
                  createTableRow(tache);
                }
              }
            }
          });

        }
        if (isStatutsSelectionneTousSelected && dateMin!="" && dateMax=="") {

          AllMembersTask.forEach(tache => {

            if (selectedDate=="ouverture") {
              if (tache.dateouverture>=dateMin) {
                createTableRow(tache);
              }

            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if ( tache.dateobjectif>=dateMin) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate==="cloture") {
              if (tache.dateTermineTache!=null) {
                if (tache.dateTermineTache>=dateMin) {
                  createTableRow(tache);
                }
              }
            }
          });

        }

        if (isStatutsSelectionneTousSelected && dateMin!="" && dateMax!="") {
          AllMembersTask.forEach(tache => {

            if (selectedDate=="ouverture") {
              if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
                createTableRow(tache);
              }

            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if ( dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate==="cloture") {
              if (tache.dateTermineTache!=null) {
                if ( dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

          });
        }

        if (!isStatutsSelectionneTousSelected && dateMin=="" && dateMax=="") {
          AllMembersTask.forEach(tache => {
            const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);
            if (TacheWitheSelectedStatut) {
              createTableRow(tache);
            }
          });
        }

        if (!isStatutsSelectionneTousSelected && dateMin=="" && dateMax!="") {
          AllMembersTask.forEach(tache => {

            const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);

            if (selectedDate=="ouverture") {
              if (TacheWitheSelectedStatut && tache.dateouverture<=dateMax) {
                createTableRow(tache);
              }
            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if (TacheWitheSelectedStatut && tache.dateobjectif<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate=="cloture") {
              if (tache.dateTermineTache!=null) {
                if (TacheWitheSelectedStatut && tache.dateTermineTache<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

          });
        }
        if (!isStatutsSelectionneTousSelected && dateMin!="" && dateMax=="") {
          AllMembersTask.forEach(tache => {
            const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);

            if (selectedDate=="ouverture") {
              if (TacheWitheSelectedStatut && tache.dateouverture>=dateMin) {
                createTableRow(tache);
              }
            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if (TacheWitheSelectedStatut && tache.dateobjectif>=dateMin) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate=="cloture") {
              if (tache.dateTermineTache!=null) {
                if (TacheWitheSelectedStatut && tache.dateTermineTache>=dateMin) {
                  createTableRow(tache);
                }
              }
            }

          });
        }
        if (!isStatutsSelectionneTousSelected && dateMin!="" && dateMax!="") {
          AllMembersTask.forEach(tache => {
            const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);

            if (selectedDate=="ouverture") {
              if (TacheWitheSelectedStatut && dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
                createTableRow(tache);
              }
            }

            if (selectedDate=="objectif") {
              if (tache.dateobjectif!=null) {
                if (TacheWitheSelectedStatut &&  dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

            if (selectedDate=="cloture") {
              if (tache.dateTermineTache!=null) {
                if (TacheWitheSelectedStatut &&  dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                  createTableRow(tache);
                }
              }
            }

          });
        }// Redraw the table
        datatableConf()
      } else {
        // Récupérer les départements sélectionnés
        //membreSelect.selectedOptions: est une propriété de l'élément <select> qui renvoie une collection de toutes les options sélectionnées.
        //Array.from(): est utilisé pour convertir la collection renvoyée par selectedOptions en un tableau JavaScript.
        // Les collections d'éléments DOM ne sont pas des tableaux
        // (option => option.value). Elle prend chaque élément (dans ce cas, une option) de la collection selectedOptions et renvoie la valeur de l'attribut value de cet élément.
        // Cela permet d'extraire la valeur de chaque option sélectionnée et de la stocker dans un nouveau tableau.
        //selectedMembres: un tableau des id valeur sélectionnées
        selectedMembres = Array.from(membreSelect.selectedOptions).map(option => option.value);
        fetch(`taches?utilisateur=${selectedMembres.join(',')}`)
                .then(response => response.json())
                .then(data => {

                  //stocker les tache des membres selectionné
                  tacheOfselectedMembres=data;
                  // Redraw the table
                  $('#example').DataTable().destroy();
                  // Effacer le contenu actuel
                  tbody.innerHTML = '';
                  const isStatutsSelectionneTousSelected=contientValeurVide(selectedStatuts);

                  if (isStatutsSelectionneTousSelected && dateMin=="" && dateMax=="") {
                    data.forEach(tache => {
                      createTableRow(tache);
                    });
                  }

                  if (isStatutsSelectionneTousSelected && dateMin=="" && dateMax!="") {
                    data.forEach(tache => {

                      if (selectedDate=="ouverture") {
                        if (tache.dateouverture<=dateMax) {
                          createTableRow(tache);
                        }
                      }


                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (tache.dateobjectif<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (tache.dateTermineTache<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }


                    });
                  }

                  if (isStatutsSelectionneTousSelected && dateMin!="" && dateMax=="") {

                    data.forEach(tache => {

                      if (selectedDate=="ouverture") {
                        if (tache.dateouverture>=dateMin) {
                          createTableRow(tache);
                        }
                      }

                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (tache.dateobjectif>=dateMin) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (tache.dateTermineTache>=dateMin) {
                            createTableRow(tache);
                          }
                        }
                      }

                    });


                  }

                  if (isStatutsSelectionneTousSelected && dateMin!="" && dateMax!="") {
                    data.forEach(tache => {



                      if (selectedDate=="ouverture") {
                        if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
                          createTableRow(tache);
                        }
                      }

                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }


                    });
                  }

                  if (!isStatutsSelectionneTousSelected && dateMin=="" && dateMax=="") {
                    data.forEach(tache => {
                      const TacheWitheSelectedStatut = selectedStatuts.some(x => x === tache.statut);
                      if (TacheWitheSelectedStatut) {
                        createTableRow(tache);
                      }
                    });
                  }

                  if (!isStatutsSelectionneTousSelected && dateMin=="" && dateMax!="") {
                    data.forEach(tache => {
                      const TacheWitheSelectedStatut = selectedStatuts.some(x => x === tache.statut);

                      if (selectedDate=="ouverture") {
                        if (TacheWitheSelectedStatut && tache.dateouverture<=dateMax) {
                          createTableRow(tache);
                        }
                      }


                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (TacheWitheSelectedStatut && tache.dateobjectif<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (TacheWitheSelectedStatut && tache.dateTermineTache<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }

                    });
                  }

                  if (!isStatutsSelectionneTousSelected && dateMin!="" && dateMax=="") {
                    data.forEach(tache => {
                      const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


                      if (selectedDate=="ouverture") {
                        if (TacheWitheSelectedStatut && tache.dateouverture>=dateMin) {
                          createTableRow(tache);
                        }
                      }

                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (TacheWitheSelectedStatut && tache.dateobjectif>=dateMin) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (TacheWitheSelectedStatut && tache.dateTermineTache>=dateMin) {
                            createTableRow(tache);
                          }
                        }
                      }


                    });
                  }

                  if (!isStatutsSelectionneTousSelected && dateMin!="" && dateMax!="") {
                    data.forEach(tache => {
                      const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


                      if (selectedDate=="ouverture") {
                        if (TacheWitheSelectedStatut &&  dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
                          createTableRow(tache);
                        }
                      }

                      if (selectedDate=="objectif") {
                        if (tache.dateobjectif!=null) {
                          if (TacheWitheSelectedStatut &&  dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }

                      if (selectedDate=="cloture") {
                        if (tache.dateTermineTache!=null) {
                          if (TacheWitheSelectedStatut &&  dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                            createTableRow(tache);
                          }
                        }
                      }


                    });
                  }
                  // Redraw the table
                  datatableConf()

                })
      }
    });

    //pour filtrer les taches par statuts
    statutSelect.addEventListener('change',()=>{
      // Redraw the table
      $('#example').DataTable().destroy();
      // Effacer le contenu actuel
      tbody.innerHTML = '';
      //selectedStatuts: un tableau des valeurs sélectionnées
      selectedStatuts = Array.from(statutSelect.selectedOptions).map(option => option.value);

      // Check if "tout sélectionner" is selected
      if (statutSelect.value == "" && dateMin=="" && dateMax=="") {
        tacheOfselectedMembres.forEach(tache => {
          createTableRow(tache);
        });
      }

      if (statutSelect.value == "" && dateMin=="" && dateMax!="") {
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }


        });
      }

      if (statutSelect.value == "" && dateMin!="" && dateMax=="") {
        tacheOfselectedMembres.forEach(tache => {


          if (selectedDate=="ouverture") {
            if (tache.dateouverture>=dateMin) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif>=dateMin) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache>=dateMin) {
                createTableRow(tache);
              }
            }
          }

        });
      }

      if (statutSelect.value == "" && dateMin!="" && dateMax!="") {
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }


        });
      }

      // Check if "tout sélectionner" is selected
      if (statutSelect.value != "" && dateMin=="" && dateMax=="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);
          if (TacheWitheSelectedStatut ){
            createTableRow(tache);
          }
        });
      }
      if (statutSelect.value != "" && dateMin=="" && dateMax!="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture<=dateMax ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif<=dateMax ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache<=dateMax ){
                createTableRow(tache);
              }
            }
          }


        });
      }

      if (statutSelect.value != "" && dateMin!="" && dateMax=="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture>=dateMin){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif>=dateMin){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache>=dateMin){
                createTableRow(tache);
              }
            }
          }


        });
      }
      if (statutSelect.value != "" && dateMin!="" && dateMax!="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut &&  dateMin<=tache.dateouverture && tache.dateouverture<=dateMax){
              createTableRow(tache);
            }
          }


          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut &&  dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut &&  dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax){
                createTableRow(tache);
              }
            }
          }

        });
      }
      // Redraw the table
      datatableConf()
    })

    //pour filtrer les taches par Date
    dateselect.addEventListener("change", ()=>{
      selectedDate=dateselect.value
      //console.log(selectedDate)
      // Redraw the table
      $('#example').DataTable().destroy();
      // Effacer le contenu actuel
      tbody.innerHTML = '';
      //selectedStatuts: un tableau des valeurs sélectionnées
      selectedStatuts = Array.from(statutSelect.selectedOptions).map(option => option.value);

      // Check if "tout sélectionner" is selected
      if (statutSelect.value == "" && dateMin=="" && dateMax=="") {
        tacheOfselectedMembres.forEach(tache => {
          createTableRow(tache);
        });
      }

      if (statutSelect.value == "" && dateMin=="" && dateMax!="") {
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }


        });
      }

      if (statutSelect.value == "" && dateMin!="" && dateMax=="") {
        tacheOfselectedMembres.forEach(tache => {


          if (selectedDate=="ouverture") {
            if (tache.dateouverture>=dateMin) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif>=dateMin) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache>=dateMin) {
                createTableRow(tache);
              }
            }
          }

        });
      }

      if (statutSelect.value == "" && dateMin!="" && dateMax!="") {
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }


        });
      }

      // Check if "tout sélectionner" is selected
      if (statutSelect.value != "" && dateMin=="" && dateMax=="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);
          if (TacheWitheSelectedStatut ){
            createTableRow(tache);
          }
        });
      }
      if (statutSelect.value != "" && dateMin=="" && dateMax!="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture<=dateMax ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif<=dateMax ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache<=dateMax ){
                createTableRow(tache);
              }
            }
          }


        });
      }

      if (statutSelect.value != "" && dateMin!="" && dateMax=="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture>=dateMin){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif>=dateMin){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache>=dateMin){
                createTableRow(tache);
              }
            }
          }


        });
      }
      if (statutSelect.value != "" && dateMin!="" && dateMax!="") {
        //lister les tache des membres selectionné
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut &&  dateMin<=tache.dateouverture && tache.dateouverture<=dateMax){
              createTableRow(tache);
            }
          }


          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut &&  dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut &&  dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax){
                createTableRow(tache);
              }
            }
          }

        });
      }
      // Redraw the table
      datatableConf()
    })

    //pour filtrer les taches par datemax
    dateMaxSelect.addEventListener('change',()=>{
      // Redraw the table
      $('#example').DataTable().destroy();
      // Effacer le contenu actuel
      tbody.innerHTML = '';
      // Stoker la date sélectionnée
      dateMax = dateMaxSelect.value;
      if (dateMin == "" && selectedStatuts=="") {

        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }

        });


      }

      if (dateMin != "" && selectedStatuts == "") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {

          if (selectedDate=="ouverture") {
            if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }

            }
          }


          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                createTableRow(tache);
              }
            }
          }


        })

      }
      if (dateMin == "" && selectedStatuts!="") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture<=dateMax ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif<=dateMax ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache<=dateMax ){
                createTableRow(tache);
              }
            }
          }

        });
      }
      if (dateMin != "" && selectedStatuts != "") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && dateMin<=tache.dateouverture && tache.dateouverture<=dateMax ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax ){
                createTableRow(tache);
              }
            }
          }

        });
      }
      // Redraw the table
      datatableConf()
    })

    //pour filtrer les taches par datemin
    dateMinSelect.addEventListener('change',()=>{
      // Redraw the table
      $('#example').DataTable().destroy();
      // Effacer le contenu actuel
      tbody.innerHTML = '';
      // Stoker la date sélectionnée
      dateMin = dateMinSelect.value;
      if (dateMax == "" && selectedStatuts=="") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {


          if (selectedDate=="ouverture") {
            if (tache.dateouverture>=dateMin) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (tache.dateobjectif>=dateMin) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (tache.dateTermineTache>=dateMin) {
                createTableRow(tache);
              }
            }
          }


        });
      }
      if (dateMax != "" && selectedStatuts == "") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {


          if (selectedDate=="ouverture") {
            if (dateMin<=tache.dateouverture && tache.dateouverture<=dateMax) {
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax) {
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax) {
                createTableRow(dateTermineTache);
              }
            }
          }


        })
      }
      if (dateMax == "" && selectedStatuts!="") {
        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);


          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && tache.dateouverture>=dateMin ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && tache.dateobjectif>=dateMin ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && tache.dateTermineTache>=dateMin ){
                createTableRow(tache);
              }
            }
          }


        });
      }
      if (dateMax != "" && selectedStatuts != "") {

        //lister les tache des membres & statuts selectionnés
        tacheOfselectedMembres.forEach(tache => {
          const TacheWitheSelectedStatut = selectedStatuts.some(x => x == tache.statut);



          if (selectedDate=="ouverture") {
            if (TacheWitheSelectedStatut && dateMin<=tache.dateouverture && tache.dateouverture<=dateMax ){
              createTableRow(tache);
            }
          }

          if (selectedDate=="objectif") {
            if (tache.dateobjectif!=null) {
              if (TacheWitheSelectedStatut && dateMin<=tache.dateobjectif && tache.dateobjectif<=dateMax ){
                createTableRow(tache);
              }
            }
          }

          if (selectedDate=="cloture") {
            if (tache.dateTermineTache!=null) {
              if (TacheWitheSelectedStatut && dateMin<=tache.dateTermineTache && tache.dateTermineTache<=dateMax ){
                createTableRow(tache);
              }
            }
          }
        });
      }
      // Redraw the table
      datatableConf()
    })


    //fonction verifier si une liste contient valeur vide
    function contientValeurVide(liste) {
      // Vérifie chaque élément de la liste
      for (let i = 0; i < liste.length; i++) {
        // Si l'élément est vide (null, undefined ou une chaîne vide), retourne true
        if (liste[i] === null || liste[i] === undefined || liste[i] === '') {
          return true;
        }
      }
      // Si aucun élément vide n'est trouvé, retourne false
      return false;
    }

     */

  </script>
</section>


</body>
</html>
