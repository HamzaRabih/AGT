<!DOCTYPE html>
<html
        lang="en"
        class="light-style layout-menu-fixed"
        dir="ltr"
        data-theme="theme-default"
        data-assets-path="../assets/"
        data-template="vertical-menu-template-free"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout.html}"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
    <meta charset="utf-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Do-it4me</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="img/LDFLOGO.png" />


    <!-- Data table ikns-->
    <link href="css/datatables.min.css" rel="stylesheet">


    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="css/boxicons.css" />
    <link rel="stylesheet" href="css/boxicons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="css/demo.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="css/perfect-scrollbar.css" />

    <link rel="stylesheet" href="css/apex-charts.css" />
    <link rel="stylesheet" href="css/myCss.css" />

    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="js/helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="js/config.js"></script>

</head>

<section layout:fragment="content">

    <!-- content div-->
    <div class="container-fluid h-auto">
        <div class="content-wrapper">

            <!-- Content -->
            <div class="container-xxl flex-grow-1 " STYLE="padding-top: 0px;margin-top: 2px;padding:0px;">

                <!-- Basic Bootstrap Table -->
                <div class="card">
                    <!--<h5 class="card-header">Table Basic</h5>-->
                    <div class="card-body">
                        <div id="messages" th:if="${not #strings.isEmpty(msg) or not #strings.isEmpty(msg1) }" class="mb-3 col-md-12">
                            <div th:if="${not #strings.isEmpty(msg)}">
                                <div class="alert alert-success" th:text="${msg}"></div>
                            </div>
                            <div th:if="${not #strings.isEmpty(msg1)}">
                                <div class="alert alert-success" th:text="${msg1}"></div>
                            </div>
                        </div>
                        <div class="table-responsive text-nowrap">
                            <!-- Extra Large Modal nouv -->
                            <div class="modal fade" id="exLargeModal" tabindex="-1" aria-hidden="true" style="padding-top: 170px">
                                <div class="modal-dialog modal-xl" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button
                                                    type="button"
                                                    class="btn-close"
                                                    data-bs-dismiss="modal"
                                                    aria-label="Close"
                                            ></button>
                                        </div>
                                        <div class="modal-body">
                                            <form id="formAccountSettings" method="POST" th:action="@{CreateTache}">
                                                <input type="hidden" class="form-control" name="idtache">
                                                <input type="hidden" th:value="${utilisateurC.idutilisateur}" class="form-control"
                                                       name="Utilisateur">
                                                <input type="hidden" name="ismemoire" id="ismemoire" value="false" required/>

                                                <div class="d-flex align-content-between justify-content-between flex-wrap  pr-0 pl-0">
                                                    <!-- Première div pour le destinataire -->
                                                    <div class="d-flex justify-content-evenly align-content-center">
                                                        <label for="idrecepteur" class="form-label align-content-center  "
                                                               STYLE="margin-right: 15px;">Destinataire</label>
                                                        <select id="idrecepteur" name="recepteur" class="select2 form-select w-px-160" required>
                                                            <option th:each="p:${Recepteurs}" th:value="${p.idutilisateur}"
                                                                    th:text="${p.prenom + ' ' + p.nom}"></option>
                                                        </select>
                                                    </div>


                                                    <!-- Deuxième div pour la tâche à réaliser -->
                                                    <div class="d-flex justify-content-evenly">
                                                        <label for="nomtache" class="form-label align-content-center"
                                                               STYLE="margin-right: 15px;">Tâche à réaliser</label>
                                                        <input type="text" class="form-control w-px-170" autofocus name="nomtache" id="nomtache" required>
                                                    </div>

                                                    <!-- Troisième div pour la durée estimée -->
                                                    <div class="d-flex justify-content-evenly">
                                                        <label class="form-label align-content-center" for="dureeEstimee"
                                                               STYLE="margin-right: 15px;">EN</label>
                                                        <div class="d-flex">
                                                            <input type="number" placeholder="Durée Estimée " id="dureeEstimee" required min="1"
                                                                   name="dureestime" class="form-control w-50"/>
                                                            <label class="form-label align-content-center" for="dureeEstimee"
                                                                   STYLE="margin-left: 10px;">Jour(s)</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <br>
                                                <div class="row g-3">

                                                    <div class="col mb-0">
                                                        <label for="idrecepteur" class="form-label align-content-center  "
                                                               STYLE="margin-right: 15px;">Statut</label>
                                                        <select id="relationTypes" name="relationTypes" class="select2 form-select w-px-160" required>
                                                            <option th:each="p : ${relationTypes}" th:value="${p}">
                                                                      <span th:text="${#strings.arrayContains(p.name(), 'SUBORDONNE') ? 'Subordonné' :
                                                                               #strings.arrayContains(p.name(), 'COLLEGUE') ? 'Collègue' :
                                                                               'Supérieur'}"></span>
                                                            </option>
                                                        </select>
                                                    </div>

                                                    <div class="col mb-0">
                                                        <label for="idrecepteur" class="form-label align-content-center  "
                                                               STYLE="margin-right: 15px;">étape</label>
                                                        <select id="etape" name="etape" class="select2 form-select w-px-160" required>
                                                            <option>Aucune</option>
                                                            <option value="Cadrage">Cadrage</option>
                                                            <option value="Livraison">Livraison</option>
                                                            <option value="Embauche">Embauche</option>
                                                            <option value="Encaissement">Encaissement</option>
                                                        </select>
                                                    </div>
                                                    <div class="col mb-0">
                                                        <label for="Priorite" class="form-label">Priorité</label>
                                                        <select id="Priorite" class="select2 form-select" name="priorite" required>
                                                            <option th:each="p:${priorites}" th:value="${p.idpriorite}"
                                                                    th:text="${p.nompriorite}"></option>
                                                        </select>
                                                    </div>

                                                    <div class="col mb-0">
                                                        <label for="DateOuverture" class="form-label">Date Ouverture</label>
                                                        <input class="form-control" type="date" name="dateouverture" min="" id="DateOuverture"
                                                               required>
                                                    </div>

                                                    <div class="col mb-0">
                                                        <label for="Proprietaires" class="form-label">Propriétaire</label>
                                                        <select id="Proprietaires" name="proprietaire" class="select2 form-select"
                                                                required="required" th:with="selectedValue=${utilisateurC.idutilisateur}">
                                                            <option th:each="p:${utilisateurList}" th:value="${p.idutilisateur}"
                                                                    th:selected="${selectedValue == p.idutilisateur}"
                                                                    th:text="${p.prenom + ' ' + p.nom}"></option>
                                                        </select>
                                                    </div>
                                                    <div class="col mb-0">
                                                        <label for="tacheparente" class="form-label">Tâche parente</label>
                                                        <select id="tacheparente" class="select2 form-select" name="tacheparente">
                                                            <!-- <option  value="">Selectionner la tâche parente</option>
                                                             <option th:each="TacheParents:${lesTacheParents}" th:value="${TacheParents.idtache}" th:text="${TacheParents.nomtache}"></option>-->
                                                        </select>
                                                    </div>

                                                    <div class="col mb-0">
                                                        <label for="type" class="form-label">Type</label>
                                                        <select class="select2 form-select" required="required"  id="type" name="type">
                                                            <option value="Opérationnel">Opérationnel</option>
                                                            <option value="Projet">Projet</option>
                                                        </select>
                                                    </div>

                                                    <div class="col mb-0">
                                                        <label class="form-label" for="Aunetachesuccessive">Tâche indexée</label>
                                                        <select class="select2 form-select" required="required" id="Aunetachesuccessive" name="aunetachesuccessive">
                                                            <option value="false">Non</option>
                                                            <option value="true">Oui</option>
                                                        </select>
                                                    </div>

                                                    <div class="col mb-0" style="padding-top: 30px;">
                                                        <button type="submit" id="submit" class="btn btn-primary "> Envoyer</button>
                                                        <button type="button"
                                                                class="btn btn-outline-secondary"
                                                                onclick="annuler()"
                                                        >Annuler
                                                        </button>
                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <table  id="example" style="width:100%" class="table table-bordered table-sm">
                                <thead>
                                <tr>
                                    <th style="width: 100%;"
                                        class="text-center Mycolor"
                                        data-bs-toggle="tooltip"
                                        data-bs-offset="0,4"
                                        data-bs-placement="top"
                                        data-bs-html="true"
                                        title="<span>Tâches</span>">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-task" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M2 2.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5zM3 3H2v1h1z"/>
                                            <path d="M5 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M5.5 7a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1zm0 4a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1z"/>
                                            <path fill-rule="evenodd" d="M1.5 7a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5zM2 7h1v1H2zm0 3.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm1 .5H2v1h1z"/>
                                        </svg>
                                        <label class="capitalize-first">Mémo</label>

                                        <!--Tache-->
                                    </th>
                                    <th  class="text-center Mycolor"
                                         data-bs-toggle="tooltip"
                                         data-bs-offset="0,4"
                                         data-bs-placement="top"
                                         data-bs-html="true"
                                         title="<span>Propriétaire</span>"><!--Proprietaire-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                                            <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z"/>
                                        </svg>
                                    </th>
                                    <th class="text-center Mycolor"
                                        data-bs-toggle="tooltip"
                                        data-bs-offset="0,4"
                                        data-bs-placement="top"
                                        data-bs-html="true"
                                        title="<span>Date ouverture</span>"
                                    ><!--date ouverture-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-open" viewBox="0 0 16 16">
                                            <path d="M8.47 1.318a1 1 0 0 0-.94 0l-6 3.2A1 1 0 0 0 1 5.4v.817l5.75 3.45L8 8.917l1.25.75L15 6.217V5.4a1 1 0 0 0-.53-.882zM15 7.383l-4.778 2.867L15 13.117zm-.035 6.88L8 10.082l-6.965 4.18A1 1 0 0 0 2 15h12a1 1 0 0 0 .965-.738ZM1 13.116l4.778-2.867L1 7.383v5.734ZM7.059.435a2 2 0 0 1 1.882 0l6 3.2A2 2 0 0 1 16 5.4V14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5.4a2 2 0 0 1 1.059-1.765z"/>
                                        </svg>
                                    </th>
                                    <th class="text-center Mycolor"
                                        data-bs-toggle="tooltip"
                                        data-bs-offset="0,4"
                                        data-bs-placement="top"
                                        data-bs-html="true"
                                        title="<span>Date objectif</span>"
                                    ><!--date objectif-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar4-event" viewBox="0 0 16 16">
                                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"/>
                                            <path d="M11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                                        </svg>
                                    </th>
                                    <th  class="text-center Mycolor"
                                         data-bs-toggle="tooltip"
                                         data-bs-offset="0,4"
                                         data-bs-placement="top"
                                         data-bs-html="true"
                                         title="<span>Durée estimée</span>"
                                    ><!--dure estime-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hourglass-split" viewBox="0 0 16 16">
                                            <path d="M2.5 15a.5.5 0 1 1 0-1h1v-1a4.5 4.5 0 0 1 2.557-4.06c.29-.139.443-.377.443-.59v-.7c0-.213-.154-.451-.443-.59A4.5 4.5 0 0 1 3.5 3V2h-1a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-1v1a4.5 4.5 0 0 1-2.557 4.06c-.29.139-.443.377-.443.59v.7c0 .213.154.451.443.59A4.5 4.5 0 0 1 12.5 13v1h1a.5.5 0 0 1 0 1zm2-13v1c0 .537.12 1.045.337 1.5h6.326c.216-.455.337-.963.337-1.5V2zm3 6.35c0 .701-.478 1.236-1.011 1.492A3.5 3.5 0 0 0 4.5 13s.866-1.299 3-1.48zm1 0v3.17c2.134.181 3 1.48 3 1.48a3.5 3.5 0 0 0-1.989-3.158C8.978 9.586 8.5 9.052 8.5 8.351z"/>
                                        </svg>
                                    </th>
                                    <th class="text-center Mycolor"
                                        data-bs-toggle="tooltip"
                                        data-bs-offset="0,4"
                                        data-bs-placement="top"
                                        data-bs-html="true"
                                        title="<span>Actions</span>"
                                    > <!--Actions-->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
                                            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"/>
                                            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"/>
                                        </svg>
                                    </th>
                                </tr>
                                </thead>
                                <tbody class="table-border table-secondary" id="tbody">
                                <tr th:each="p:${tacheList}">
                                    <td style=" display: flex;">
                                        <p th:text="${p.nomtache}" style="white-space: pre-wrap;margin: 0;max-width: 350px;min-height: 35px;height: auto"></p>
                                    </td>

                                    <td th:text="${p.proprietaire!=null?p.proprietaire.prenom+' '+p.proprietaire.nom:'(sans proprietaire)'}"></td>
                                    <td th:text="${p.dateouverture != null ? #dates.format(p.dateouverture, 'dd/MM/yy') : ''}"></td>
                                    <td th:text="${p.dateobjectif != null ? #dates.format(p.dateobjectif, 'dd/MM/yy') : ''}"></td>
                                    <td th:text="${p.dureestime}"></td>
                                    <td>
                                        <div class="dropdown">
                                            <button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown">
                                                <i class="bx bx-dots-vertical-rounded"></i>
                                            </button>
                                            <div class="dropdown-menu">
                                                <a class="dropdown-item" th:attr="data-id=${p.idtache}" onclick="editMemo(this)"
                                                ><i class="bx bx-edit-alt me-2"></i> Éditer</a
                                                >
                                                <a class="dropdown-item"  onclick="confirmDelete(event)" th:href="@{/deleteMemo/{id}(id=${p.idtache})}">
                                                    <i class="bx bx-trash me-2"></i> Supprimer</a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!--/ Basic Bootstrap Table -->
            </div>
        </div>
    </div>
    <!--/ content div-->



    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="js/jquery.js"></script>
    <script src="js/popper.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/perfect-scrollbar.js"></script>

    <script src="js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="js/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="js/main.js"></script>

    <!-- Page JS -->
    <script src="js/dashboards-analytics.js"></script>
    <script src="js/pages-account-settings-account.js"></script>

    <!-- Place this tag in your head or just before your close body tag. -->

    <script src="js/myJs.js"></script>
    <!-- liens pour les websoket + Stom +Jquery. -->
    <script src="js/jquery.min.js"></script>
    <script src="js/sockjs.min.js"></script>
    <script src="js/stomp.min.js" ></script>
    <!-- le script des websoket notification. -->
    <script src="js/notifWebSocket.js"></script>
    <!-- Data table -->
    <script src="js/datatables.min.js"></script>
    <script src="js/MyDatatableConf.js"></script>

</section>



</body>

</body>
</html>
